process {
    skipPublishDir = true
    executor = 'k8s'
    scratch = true
    stageOutMode = 'move'
}

k8s {
    debug.yaml = true
    namespace = 'ftschirpke'
    serviceAccount = 'nextflow'
    workDir = '/input/data/work/'
    projectDir = '/input/data/project/'
    imagePullPolicy = 'IfNotPresent'
    runAsUser = 0
    fetchNodeName = true
    storageMountPath = '/input'
    scheduler {
        name = 'workflow-scheduler'
        autoClose = false
    }
}

executor {
    queueSize = 300
}

report {
    enabled = true
    file = '/input/data/output/report.html'
}

dag {
    enabled = true
    file = '/input/data/output/dag.html'
}

timeline {
    enabled = true
    file = '/input/data/output/timeline.html'
}

trace {
    enabled = true
    sep = ','
    raw = true
    file = '/input/data/output/trace.csv'
    fields = 'task_id,hostname,hash,native_id,process,tag,name,status,exit,module,container,cpus,time,disk,memory,attempt,submit,start,complete,duration,realtime,queue,%cpu,%mem,rss,vmem,peak_rss,peak_vmem,rchar,wchar,syscr,syscw,read_bytes,write_bytes,vol_ctxt,inv_ctxt,workdir,scratch,error_action,create_bash_wrapper_time,create_request_time,submit_to_scheduler_time,submit_to_k8s_time'
}
k8s {
    storageClaimName = 'ceph-data'
}

includeConfig 'nextflow_node_selectors.config'
