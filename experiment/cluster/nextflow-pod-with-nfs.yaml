apiVersion: v1
kind: Pod
metadata:
  name: nextflow-with-nfs
spec:
  nodeSelector: 
    friedrich: manager
  containers:
  - name: nextflow-with-nfs
    image: fabianlehmann/test1:nxf_vla_exp
    imagePullPolicy: Always
    command:
      - /bin/sh
      - "-c"
      - "sleep infinity"
    workingDir: /experiments/experiment
    env:
    - name: NXF_WORK
      value: /input/data/work/
    - name: NXF_ANSI_LOG
      value: 'false'
    volumeMounts:
      - mountPath: /input
        name: input
      - mountPath: /experiments
        name: exp
      - mountPath: /nfs
        name: nfs
        readOnly: true
    securityContext:
      runAsUser: 0
    resources:
      requests: 
        memory: 3G
  serviceAccountName: la-nextflow
  volumes:
  - name: input
    persistentVolumeClaim:
      claimName: ceph-data
  - name: exp
    persistentVolumeClaim:
      claimName: ceph-exp
  - name: nfs
    persistentVolumeClaim:
      claimName: nfs-data
      readOnly: true
  securityContext:
    runAsUser: 0
